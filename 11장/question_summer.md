### 뉴스 피드의 순서를 어떻게 보장하고 중복은 어떻게 방지할까?

<details>
<summary> 예시 답안 </summary><br>

**[ Clock Skew 해결책 ]**

강화된 ID 체계: **timestamp_sequence_serverID**
조합 방식:
- timestamp: 2025-08-04 14:23:45.123 (밀리초까지)
- sequence: 같은 밀리초에 여러 포스트가 생성되면 1, 2, 3... 순번
- serverID: 어느 서버에서 만들어졌는지 구분 (예: server001)

실제 예시:
- 20250804142345123_001_server001 (첫 번째 포스트)
- 20250804142345123_002_server001 (같은 시간, 두 번째 포스트)
- 20250804142345124_001_server002 (1밀리초 후, 다른 서버)

Clock Skew 해결책 :서버들의 시계가 다를 수 있음을 고려

허용 범위 설정: "최대 10초까지는 순서가 바뀔 수 있다" 고 정의<br>
지연 처리: 포스트를 받고 10초 기다린 후 정렬해서 처리<br>
NTP 동기화: 모든 서버의 시계를 주기적으로 보정<br>

**[ 다층 중복 방지 시스템 ]**

데이터베이스 레벨)<br>
데이터베이스 테이블에 "같은 포스트 ID는 두 번 저장될 수 없다" 규칙 설정<br>
중복 저장을 시도하면 자동으로 에러 발생해서 막아줌<br>
확실하지만 속도가 느림<br>

캐시 레벨)<br>
Redis Set 활용: 최근 1시간 동안 처리한 포스트 ID들을 Set에 저장<br>
Redis ZSet 활용: 시간순으로 정렬된 포스트 리스트 유지<br>
새 포스트가 오면 Redis에서 먼저 확인 → 이미 있으면 바로 무시<br>
데이터베이스보다 100배 이상 빠름<br>

애플리케이션 레벨)<br>
아래의 4단계를 활용하여 머지
1. ID 매칭: 모든 포스트의 고유 ID 비교<br>
2. 상태 구분: 임시/확정/실시간 포스트 분류<br>
3. 우선순위 적용: 서버 확정 데이터 > 실시간 데이터 > 로컬 임시 데이터<br>
4. 시간순 정렬: 최종적으로 시간 순서대로 배치<br>

위의 단계들 중 1개 이상의 단계를 함께 사용하면 안정성을 높일 수 있음

</details>


# 채팅 시스템 설계

## 1단계 문제 이해 및 설계 범위 확정
1. 1:1 채팅 및 그룹 채팅 모두 지원
2. 모비일, 웹 모두 지원
3. 단일 계정으로 여러 단말로 동시 접속 지원
4. 푸시 알림
5. DAU 5000만
6. 그룹 채팅 최대 100명
7. 사용자 접속 상태 표시를 지원해야함.
8. 텍스트만 주고 받을 수 있음 (메시지 길이는 최대 100,000)
9. 종단간 암호화는 일단 지원하지 않음
10. 채팅 기록은 영원히 보관

### 이든 설계;;
<img width="1302" height="741" alt="image" src="https://github.com/user-attachments/assets/de22beec-f6f5-4319-b701-03dc3300c51a" />

#### 채팅
1. 단말과 웹은 채팅 서버와 웹 소켓 연결을 맺음
2. 무중단 배포를 위해 단말과 채팅 서버에 프록시를 그리고 채팅 서버 사이에 Message Queue를 둠
    - 단말은 배포 전 블루 그룹과 웹 소켓 커넥션을 맺고있고, 배포를 위해 그린 그룹도 배포되어 있는 상태
    - 블루 그룹은 단말과의 웹 소켓 연결을 close 하고, 스트리밍 응답 또는 메시지를 Broker에 Produce
    - 단말은 웹 소켓 라우터를 통해 그린 그룹과 웹 소켓 연결을 맺음
    - 그린 그룹은 Broker로부터 메시지를 Consume 하여 단말에 전달
3. 커넥션을 길게 맺는다는 점에서 웹 소켓을 선호하지는 않지만, 유저 채팅(1:1, 그룹)에 있어서는 여러 이점이 있을 것 같아 웹 소켓 선정
    - ex. 현재 입력중인 유저 표시 등
    - 방 타입에 따라 연결 방식을 다르게 가져갈 수도 있을 듯 (푸시만 받는 방의 경우는 웹 소켓 연결은 필요없음)
4. 알림 서버는 별도 도메인이라고 판단되어 분리하였음.
    - 웹은 별도 제 3자 서비스를 거치지 않고 알림을 받도록 했음.

## 2단계 개략적 설계안 제시 및 동의 구하기
1. 


